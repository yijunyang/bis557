<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>homework-3 â€¢ bis557</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="homework-3">
<meta property="og:description" content="bis557">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bis557</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework-1.html">homework-1</a>
    </li>
    <li>
      <a href="../articles/homework-2.html">homework-2</a>
    </li>
    <li>
      <a href="../articles/homework-3.html">homework-3</a>
    </li>
    <li>
      <a href="../articles/homework-4.html">homework-4</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="homework-3_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="homework-3_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>homework-3</h1>
            
      
      
      <div class="hidden name"><code>homework-3.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bis557</span><span class="op">)</span></code></pre></div>
<div id="problem-1" class="section level1">
<h1 class="hasAnchor">
<a href="#problem-1" class="anchor"></a>Problem 1</h1>
<blockquote>
<p>CASL 5.8 Exercise number 2. Include the write up in your homework-2 vignette.</p>
<p>We mentioned that the Hessian matrix in Equation 5.19 can be more illconditioned than the matrix <span class="math inline">\(X^tX\)</span> itself. Generate a matrix <span class="math inline">\(X\)</span> and propabilities <span class="math inline">\(p\)</span> such that the linear Hessian (<span class="math inline">\(X^tX\)</span>) is well-conditioned but the logistic variation is not.</p>
</blockquote>
<div id="linear-hessian" class="section level3">
<h3 class="hasAnchor">
<a href="#linear-hessian" class="anchor"></a>Linear Hessian</h3>
<p>First, calculate linear Hessian (<span class="math inline">\(X^tX\)</span>). Calculate the ratio of max singular value to minimun singular value. The result is small, which means linear Hessian is well-conditioned.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">X</span>

<span class="co"># Refer to CASL p100</span>
<span class="va">singular_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">$</span><span class="va">d</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">singular_values</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">singular_values</span><span class="op">)</span>
<span class="co">#&gt; [1] 9</span></code></pre></div>
</div>
<div id="logistic-variation" class="section level3">
<h3 class="hasAnchor">
<a href="#logistic-variation" class="anchor"></a>Logistic Variation</h3>
<p>Then, calculate logistic variation(<span class="math inline">\(X^tDX\)</span>). Calculate the ratio of max singular value to minimun singular value. The result is large, which means logistic variation is ill-conditioned.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">X</span> <span class="op">%*%</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span>
<span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>
<span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">D</span> <span class="op">%*%</span> <span class="va">X</span>
<span class="va">singular_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">$</span><span class="va">d</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">singular_values</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">singular_values</span><span class="op">)</span>
<span class="co">#&gt; [1] 921.9756</span></code></pre></div>
</div>
</div>
<div id="problem-2" class="section level1">
<h1 class="hasAnchor">
<a href="#problem-2" class="anchor"></a>Problem 2</h1>
<blockquote>
<p>Describe and implement a first-order solution for the GLM maximum likelihood problem using only gradient information, avoiding the Hessian matrix. Include both a constant step size along with an adaptive one. You may use a standard adaptive update Momentum, Nesterov, AdaGrad, Adam, or your own. Make sure to explain your approach and compare itâ€™s performance with a constant step size.</p>
</blockquote>
<div id="set-up-the-dataset-for-comparison" class="section level3">
<h3 class="hasAnchor">
<a href="#set-up-the-dataset-for-comparison" class="anchor"></a>Set up the dataset for comparison</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"penguinsi"</span><span class="op">)</span>
<span class="va">penguinsi</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">penguinsi</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="va">form</span> <span class="op">&lt;-</span> <span class="va">sex</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">bill_depth_mm</span>
<span class="va">d</span> <span class="op">=</span> <span class="va">penguinsi</span>
<span class="va">mms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_model_matrices.html">make_model_matrices</a></span><span class="op">(</span><span class="va">form</span>, <span class="va">d</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">mms</span><span class="op">$</span><span class="va">X</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">mms</span><span class="op">$</span><span class="va">Y</span></code></pre></div>
</div>
<div id="results-for-constant-step" class="section level3">
<h3 class="hasAnchor">
<a href="#results-for-constant-step" class="anchor"></a>Results for constant step</h3>
<p>The function <code>glm_constant</code> has been established in a seperate file <code>gradient_descent_glm.R</code>. Now check the results for a constant step.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">fit_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glm_constant.html">glm_constant</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, mu_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span>, var_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="va">eta</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $beta</span>
<span class="co">#&gt;                       [,1]</span>
<span class="co">#&gt; (Intercept)    -21.3144545</span>
<span class="co">#&gt; bill_length_mm   0.2314536</span>
<span class="co">#&gt; bill_depth_mm    0.6548705</span></code></pre></div>
</div>
<div id="results-for-adaptive-step" class="section level3">
<h3 class="hasAnchor">
<a href="#results-for-adaptive-step" class="anchor"></a>Results for adaptive step</h3>
<p>We can incorporate a term known as the <em>momentum</em> into the algorithm. The gradient computed on each mini-batch is used to update the momentum term, and the momentum term is then used to update the current weights.This setup gives the SGD algorithm three useful properties: if the gradient remains relatively unchanged over several steps it will â€˜pick-up speedâ€™ (momentum) and effectively use a larger learning rate; if the gradient is changing rapidly, the step-sizes will shrink accordingly; when passing through a saddle point, the built up momentum from prior steps helps propel the algorithm past the point. (refer to CASL p230)</p>
<p>The function <code>glm_adapt</code> has been established in a seperate file <code>gradient_descent_glm.R</code>. Now check the results for an adaptive step.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">fit_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glm_adapt.html">glm_adapt</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, mu_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span>, var_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="va">eta</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $beta</span>
<span class="co">#&gt;                       [,1]</span>
<span class="co">#&gt; (Intercept)    -25.7497962</span>
<span class="co">#&gt; bill_length_mm   0.2805351</span>
<span class="co">#&gt; bill_depth_mm    0.7894320</span></code></pre></div>
</div>
<div id="reference-results" class="section level3">
<h3 class="hasAnchor">
<a href="#reference-results" class="anchor"></a>Reference results</h3>
<p>Use the results from <code>glm</code> function as the reference.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">fit_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">form</span>, <span class="va">penguinsi</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span>
<span class="co">#&gt;    (Intercept) bill_length_mm  bill_depth_mm </span>
<span class="co">#&gt;    -25.7498909      0.2805361      0.7894348</span></code></pre></div>
</div>
<div id="conclusion" class="section level3">
<h3 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h3>
<p>Combine the results together to compare, we can see that the constant step method fits fairly good, but not quite close to the reference. The adaptive step method fits much better, and even equivalent to the reference.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">fit_c</span><span class="op">$</span><span class="va">beta</span>, <span class="va">fit_a</span><span class="op">$</span><span class="va">beta</span>, <span class="va">fit_ref</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'constant'</span>,<span class="st">'adaptive'</span>,<span class="st">'reference'</span><span class="op">)</span>
<span class="va">compare</span>
<span class="co">#&gt;                   constant    adaptive   reference</span>
<span class="co">#&gt; (Intercept)    -21.3144545 -25.7497962 -25.7498909</span>
<span class="co">#&gt; bill_length_mm   0.2314536   0.2805351   0.2805361</span>
<span class="co">#&gt; bill_depth_mm    0.6548705   0.7894320   0.7894348</span></code></pre></div>
</div>
</div>
<div id="problem-3" class="section level1">
<h1 class="hasAnchor">
<a href="#problem-3" class="anchor"></a>Problem 3</h1>
<blockquote>
<p>Describe and implement a classification model generalizing logistic regression to accommodate more than two classes.</p>
</blockquote>
<div id="set-up-the-dataset-for-comparison-1" class="section level3">
<h3 class="hasAnchor">
<a href="#set-up-the-dataset-for-comparison-1" class="anchor"></a>Set up the dataset for comparison</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"penguinsi"</span><span class="op">)</span>
<span class="co"># penguinsi$species &lt;- as.numeric(penguinsi$species)</span>
<span class="co"># 1:"Adelie" 2:"Chinstrap" 3:"Gentoo"</span>
<span class="va">form</span> <span class="op">&lt;-</span> <span class="va">species</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">bill_depth_mm</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">penguinsi</span></code></pre></div>
</div>
<div id="implement-a-classification-model" class="section level3">
<h3 class="hasAnchor">
<a href="#implement-a-classification-model" class="anchor"></a>Implement a classification model</h3>
<p>The function <code>multiclass_logistic</code> has been established in a seperate file <code>multiclass_logistic.R</code>. Now check the classification results. The results contain: (1) beta coefficients; (2) the misclassification error; (3) a detailed classification table</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/multiclass_logistic.html">multiclass_logistic</a></span><span class="op">(</span><span class="va">form</span>, <span class="va">d</span><span class="op">)</span>
<span class="co">#&gt; $Coefficients</span>
<span class="co">#&gt;           (Intercept) bill_length_mm bill_depth_mm</span>
<span class="co">#&gt; Adelie       24.13554     -2.2102803     3.9988123</span>
<span class="co">#&gt; Chinstrap   -31.63739      0.3543506     0.8010768</span>
<span class="co">#&gt; Gentoo       49.03383      0.5577040    -4.5335857</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $MisclassificationError</span>
<span class="co">#&gt; [1] 0.04360465</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ClassificationTable</span>
<span class="co">#&gt;            Y</span>
<span class="co">#&gt; Y_hat       Adelie Chinstrap Gentoo</span>
<span class="co">#&gt;   Adelie       151         5      0</span>
<span class="co">#&gt;   Chinstrap      1        56      2</span>
<span class="co">#&gt;   Gentoo         0         7    122</span></code></pre></div>
</div>
<div id="use-multinomial-regression-as-a-reference-answer" class="section level3">
<h3 class="hasAnchor">
<a href="#use-multinomial-regression-as-a-reference-answer" class="anchor"></a>Use multinomial regression as a reference answer</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span>

<span class="co"># build model</span>
<span class="va">multinomModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">penguinsi</span><span class="op">)</span>
<span class="co">#&gt; # weights:  12 (6 variable)</span>
<span class="co">#&gt; initial  value 377.922627 </span>
<span class="co">#&gt; iter  10 value 26.680270</span>
<span class="co">#&gt; iter  20 value 24.006223</span>
<span class="co">#&gt; iter  30 value 23.973300</span>
<span class="co">#&gt; iter  40 value 23.957800</span>
<span class="co">#&gt; iter  40 value 23.957800</span>
<span class="co">#&gt; final  value 23.957800 </span>
<span class="co">#&gt; converged</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multinomModel</span><span class="op">)</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; multinom(formula = form, data = penguinsi)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;           (Intercept) bill_length_mm bill_depth_mm</span>
<span class="co">#&gt; Chinstrap   -26.30741       2.252261     -3.979117</span>
<span class="co">#&gt; Gentoo       23.22270       2.737199     -8.327064</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Std. Errors:</span>
<span class="co">#&gt;           (Intercept) bill_length_mm bill_depth_mm</span>
<span class="co">#&gt; Chinstrap    14.00946      0.7109681      1.505729</span>
<span class="co">#&gt; Gentoo       20.23527      0.7283796      1.825504</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual Deviance: 47.9156 </span>
<span class="co">#&gt; AIC: 59.9156</span>

<span class="co"># prediction performance</span>
<span class="va">predicted_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">multinomModel</span>, <span class="va">penguinsi</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">predicted_class</span>, <span class="va">penguinsi</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>
<span class="co">#&gt;                </span>
<span class="co">#&gt; predicted_class Adelie Chinstrap Gentoo</span>
<span class="co">#&gt;       Adelie       149         3      0</span>
<span class="co">#&gt;       Chinstrap      3        61      2</span>
<span class="co">#&gt;       Gentoo         0         4    122</span>

<span class="co"># misclassification error</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">predicted_class</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">penguinsi</span><span class="op">$</span><span class="va">species</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.03488372</span></code></pre></div>
</div>
<div id="conclusion-1" class="section level3">
<h3 class="hasAnchor">
<a href="#conclusion-1" class="anchor"></a>Conclusion</h3>
<p>The misclassification error is 4.4% for my method and 3.5% for <code>multinom</code> function in <code>nnet</code> package. They are similar while <code>multinom</code> performs better in this case.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yijun Yang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
